var Me=Object.defineProperty;var pe=Object.getOwnPropertySymbols;var Be=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable;var ae=(a,w,b)=>w in a?Me(a,w,{enumerable:!0,configurable:!0,writable:!0,value:b}):a[w]=b,k=(a,w)=>{for(var b in w||(w={}))Be.call(w,b)&&ae(a,b,w[b]);if(pe)for(var b of pe(w))Ie.call(w,b)&&ae(a,b,w[b]);return a};(function(a,w){typeof exports=="object"&&typeof module!="undefined"?module.exports=w(require("react")):typeof define=="function"&&define.amd?define(["react"],w):(a=typeof globalThis!="undefined"?globalThis:a||self,a["@rvision/use-form"]=w(a.react))})(this,function(a){"use strict";function w(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var b=w(a);const de=["object","function"];let me=Date.now();const ye=()=>{const e=a.useRef(new WeakMap);return a.useEffect(()=>()=>{e&&e.current&&(e.current=new WeakMap)},[]),a.useCallback((t={})=>{const s=e.current;if(s.has(t))return s.get(t);if(!de.includes(typeof t))return`key-${t}`;const i=(++me).toString(36);return s.set(t,i),i},[])};var X={exports:{}},x={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Z=Object.getOwnPropertySymbols,we=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;function le(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function be(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var r={},t=0;t<10;t++)r["_"+String.fromCharCode(t)]=t;var s=Object.getOwnPropertyNames(r).map(function(p){return r[p]});if(s.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(p){i[p]=p}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}be();/** @license React v17.0.2
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ee=b.default,$=60103;if(x.Fragment=60107,typeof Symbol=="function"&&Symbol.for){var q=Symbol.for;$=q("react.element"),x.Fragment=q("react.fragment")}var Oe=Ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_e=Object.prototype.hasOwnProperty,ge={key:!0,ref:!0,__self:!0,__source:!0};function P(e,r,t){var s,i={},p=null,R=null;t!==void 0&&(p=""+t),r.key!==void 0&&(p=""+r.key),r.ref!==void 0&&(R=r.ref);for(s in r)_e.call(r,s)&&!ge.hasOwnProperty(s)&&(i[s]=r[s]);if(e&&e.defaultProps)for(s in r=e.defaultProps,r)i[s]===void 0&&(i[s]=r[s]);return{$$typeof:$,type:e,key:p,ref:R,props:i,_owner:Oe.current}}x.jsx=P,x.jsxs=P,X.exports=x;const L=X.exports.jsx,M=e=>!Number.isNaN(e),h=e=>parseInt(e,10),ee=e=>typeof e=="function",{isArray:O}=Array,re=JSON.stringify,A=Object.keys,ke=/\[([^\]]+)\]/g;let B={};const I=e=>{if(!e)return[];if(B[e])return B[e];const r=e.replace(ke,".$1").split(".");return B[e]=r,r},U=e=>typeof e!="object"||e===null?e:e instanceof Date?new Date(e.getTime()):O(e)?e.reduce((r,t,s)=>(r[s]=U(t),r),[]):e instanceof Object?A(e).reduce((r,t)=>(r[t]=U(e[t]),r),{}):e,y=(e,r)=>{if(!O(e))return y(I(e),r);if(r===void 0)return;if(e.length===0)return r;const t=e[0];if(e.length===1)return r[t];if(r[t]===void 0)return;const s=h(e[1]);return M(s)?e.length===2?r[t][s]:y(e.slice(2),r[t][s]):y(e.slice(1),r[t])},_=(e,r,t)=>{if(!O(e)){_(I(e),r,t);return}if(e.length===0)return;const s=e[0];if(e.length===1){r[s]=t;return}const i=h(e[1]);M(i)?(r[s]=r[s]===void 0?[]:r[s],r[s][i]=r[s][i]===void 0?{}:r[s][i],e.length===2?r[s][i]=t:_(e.slice(2),r[s][i],t)):(r[s]=r[s]===void 0?{}:k({},r[s]),_(e.slice(1),r[s],t))},S=(e,r)=>{if(!O(e)){S(I(e),r);return}if(e.length===0||r===void 0)return;const t=e[0];if(e.length===1){delete r[t];return}if(r[t]===void 0)return;const s=e[1],i=h(s);M(i)?e.length===2?delete r[t][i]:S(e.slice(2),r[t][i]):S(e.slice(1),r[t][i])},D=(e,r)=>{if(!O(e)){D(I(e),r);return}S(e,r);const t=e.map((s,i)=>i===0?[...e]:[...e].slice(0,-1*i));for(const s of t){const i=y(s,r);i!==void 0&&(O(i)?(i.length===0||i.every(p=>A(p||{}).length===0))&&S(s,r):A(i||{}).length===0&&S(s,r))}},V=(e,r)=>{const t=y(e,r);if(t&&!O(t)){const s=k({},r);return D(e,s),s}return r},ne=(e,r,t)=>{const s=y(e,r);if(s&&O(s)){const i=k({},r),p=t([...s]);return _(e,i,p),i}return r},W=(e,r,t)=>`${t||""} ${r||""} ${e.type?`error-${e.type}`:""}`.trim(),H=e=>e&&e.focus?(e.focus(),!0):!1;return({defaultValues:e={},mode:r="onSubmit",classNameError:t=null,shouldFocusError:s=!1,resolver:i=p=>({})})=>{const[p,R]=a.useState(e),[d,E]=a.useState({}),Y=a.useRef(!1),z=a.useRef(!1),j=a.useRef(new Map),te=a.useRef(""),se=ye(),K=a.useRef(new Map),oe=a.useRef(new Map),Re=r==="onBlur",Ne=r==="onChange",ce=n=>{te.current=re(n),R(U(n))};a.useEffect(()=>(ce(e),()=>{B={}}),[e]);const g=(n=null,c=d)=>n===null?A(c||{}).length>0:y(n,c)!==void 0,J=(n,c=d)=>{if(g(n)){const o=k({},c);return D(n,o),E(o),o}return c},Se=n=>{const c=k({},d);for(const o of A(n))g(o)&&D(o,c),_(o,c,n[o]);return E(c),c},je=(n="",c=p)=>{const o=i(c),f=y(n,o),u=k({},o);return D(n,u),f!==void 0&&_(n,u,f),E(u),u},ie=(n="")=>y(n,p),C=(n,c,o=!0)=>{R(f=>{const u=k({},f);if(_(n,u,c),z.current=te.current!==re(u),o&&(g(n)||Ne)){const m=J(n),l=y(n,i(u));l&&(_(n,m,l),E(m))}return u}),Y.current=!0},Ce=(n,c)=>{const o=[...y(n,p),c];C(n,o,!1);const f=V(n,d);return E(f),o},Te=(n,c)=>{const o=[c,...y(n,p)];C(n,o,!1);let f=V(n,d);return f=ne(n,f,u=>[void 0,...u]),E(f),o},xe=(n,c)=>{const o=y(n,p).filter((u,m)=>c!==m);C(n,o,!1);let f=V(n,d);return f=J(`${n}.${c}`,f),f=ne(n,f,u=>(u.splice(c,1),u)),E(f),o},Ae=(n,c,o)=>{const f=(v,N,T,fe)=>{const Q=y(N,v);if(O(Q)){const F=[...Q],Fe=F[T];return F[T]=F[fe],F[fe]=Fe,F}return Q},u=f(p,n,c,o);C(n,u);const m=f(d,n,c,o),l=k({},d);_(n,l,m),E(l)},G=n=>{const{name:c,type:o,checked:f,options:u,files:m,multiple:l}=n.target;let{value:v,valueAsNumber:N}=n.target;switch(o){default:break;case"checkbox":v=f;break;case"range":v=N;break;case"number":v===""?v=null:(v=Number.parseFloat(v),M(v)||(v=void 0));break;case"file":v=l?m:m.item(0);break;case"select-multiple":v=[...u].filter(T=>T.selected).map(T=>T.value);break}C(c,v)},ue=n=>{const{name:c}=n.target,o=y(c,i(p));if(o){const f=k({},d);_(c,f,o),E(f),s&&H(j.current.get(c))}else J(c)},De=n=>{n&&j.current.set(n.name,n)};return{getValue:ie,setValue:C,register:(n,{className:c=""}={})=>{const o=ie(n),f=g(n),u=`${n}*${o}*${f}*${c}`,m=Re?ue:void 0;if(K.current.has(u)){const N=K.current.get(u);return N.onChange=G,N.onBlur=m,N}const l={key:n,name:n,"aria-invalid":`${f}`,className:W({},f?t:!1,c),onChange:G,onBlur:m,ref:De};o===!0||o===!1?l.checked=o:l.value=`${o}`=="0"?o:o||"";const v=oe.current.get(n);return K.current.delete(v),K.current.set(u,l),oe.current.set(n,u),l},onChange:G,onBlur:ue,getRef:n=>j.current.get(n),setRef:(n,c)=>{c&&j.current.set(n,c)},trigger:je,handleSubmit:n=>c=>{c&&c.preventDefault&&c.preventDefault();const o=i(p);if(E(o),g(null,o)){if(s){let f=!1;j.current.forEach((u,m)=>{!f&&g(m,o)&&(f=H(u))})}return!1}return n(p),!0},hasError:g,clearError:J,setErrors:Se,append:Ce,prepend:Te,remove:xe,swap:Ae,key:se,reset:(n=e,c=!0)=>{ce(n),Y.current=!1,z.current=!1,c&&E(i(n))},Error:({for:n,children:c})=>{const o=y(n,d);return!o||O(o)?!1:ee(c)?c(o):L("span",{className:W(o,t),children:o.message})},Errors:({children:n,focusable:c=!1})=>{if(!g())return!1;const o=Array.from(j.current).filter(u=>g(u[0])).map(u=>{const[m,l]=u;return{error:y(m,d),element:l}});if(o.length===0)return!1;const f=o.map(({error:u,element:m})=>L("li",{className:W(u,t),children:c?L("a",{onClick:()=>H(m),children:u.message}):u.message},se(u)));return ee(n)?n(f):f},formState:{errors:d,isValid:!g(),isTouched:Y.current,isDirty:z.current}}}});
