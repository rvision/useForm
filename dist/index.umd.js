var qe=Object.defineProperty,$e=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var ge=Object.getOwnPropertySymbols;var er=Object.prototype.hasOwnProperty,rr=Object.prototype.propertyIsEnumerable;var ve=(l,u,E)=>u in l?qe(l,u,{enumerable:!0,configurable:!0,writable:!0,value:E}):l[u]=E,k=(l,u)=>{for(var E in u||(u={}))er.call(u,E)&&ve(l,E,u[E]);if(ge)for(var E of ge(u))rr.call(u,E)&&ve(l,E,u[E]);return l},q=(l,u)=>$e(l,Pe(u));(function(l,u){typeof exports=="object"&&typeof module!="undefined"?u(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],u):(l=typeof globalThis!="undefined"?globalThis:l||self,u(l["@rvision/use-form"]={},l.react))})(this,function(l,u){"use strict";function E(r){return r&&typeof r=="object"&&"default"in r?r:{default:r}}var we=E(u);const $=r=>!Number.isNaN(r),Re=r=>parseInt(r,10),P=r=>typeof r=="function",{isArray:x}=Array,ee=r=>JSON.stringify(r,(s,o)=>o instanceof Set?[...o].sort():o),re=Object.keys,D={},C=()=>D;let Se=9999;const M=new WeakMap,ke=r=>{let s=M.get(r);return s||(s=(++Se).toString(36).split("").reduce((o,c)=>c+o,""),M.set(r,s)),s},se=r=>{let s;return r instanceof Set?s=new Set([...r]):s=x(r)?[...r]:k({},r),M.has(r)&&(M.set(s,M.get(r)),M.delete(r)),s},Ne=/\[([^\]]+)\]/g;let z=new Map;const K=r=>{if(!r)return[];let s=z.get(r);return s||(s=r.replace(Ne,".$1").split("."),z.set(r,s),s)},Oe=()=>{z=new Map},U=(r,s)=>{if(s!==void 0)return r.length===0?s:U(r.slice(1),s[r[0]])},R=(r,s)=>U(K(r),s),W=(r,s,o)=>{const{length:c}=r,i=r[0];switch(c){case 0:s=o;return;case 1:s[i]=o;return;default:{const y=s[i]===void 0,m=r[1],v=$(Re(m)),_=v?[]:{};s[i]=y?_:se(s[i]),v?(s[i][m]=s[i][m]===void 0?{}:se(s[i][m]),W(r.slice(2),s[i][m],o)):W(r.slice(1),s[i],o)}break}},N=(r,s,o)=>{const c=k({},s);return W(K(r),c,o),c},I=(r,s)=>{const{length:o}=r;if(o===0||s===void 0)return;const c=r[0];if(o===1){delete s[c];return}I(r.slice(1),s[c])},te=r=>re(r||D).length===0,Te=(r,s)=>{I(r,s),r.map((c,i)=>i===0?[...r]:[...r].slice(0,-1*i)).forEach(c=>{const i=U(c,s);i!==void 0&&(x(i)?(i.length===0||i.every(te))&&(i.message||I(c,s)):te(i)&&I(c,s))})},j=(r,s)=>{const o=k({},s);return Te(K(r),o),o},be=r=>{const{value:s,type:o,checked:c,options:i,files:y,multiple:m,valueAsNumber:v,valueAsDate:_}=r.target;switch(o){case"checkbox":return c;case"range":return v;case"date":return _;case"number":{if(s==="")return null;const w=Number.parseFloat(s);return $(w)?w:void 0}case"file":return m?y:y.item(0);case"select-multiple":return[...i].filter(w=>w.selected).map(w=>w.value);default:return s}},ne=(r,s,o)=>{if(x(r)){const c=[...r];return[c[s],c[o]]=[c[o],c[s]],c}return r},Y=(r,s,o)=>`${o||""} ${s||""} ${r.type?`error-${r.type}`:""}`.trim();var oe={exports:{}},J={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var he=we.default,Ce=Symbol.for("react.element"),Me=Symbol.for("react.fragment"),Ae=Object.prototype.hasOwnProperty,xe=he.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,De={key:!0,ref:!0,__self:!0,__source:!0};function ce(r,s,o){var c,i={},y=null,m=null;o!==void 0&&(y=""+o),s.key!==void 0&&(y=""+s.key),s.ref!==void 0&&(m=s.ref);for(c in s)Ae.call(s,c)&&!De.hasOwnProperty(c)&&(i[c]=s[c]);if(r&&r.defaultProps)for(c in s=r.defaultProps,s)i[c]===void 0&&(i[c]=s[c]);return{$$typeof:Ce,type:r,key:y,ref:m,props:i,_owner:xe.current}}J.Fragment=Me,J.jsx=ce,J.jsxs=ce,oe.exports=J;const H=oe.exports.jsx,p=r=>{const s=u.useRef(r);return s.current=r,u.useCallback((...o)=>s.current(...o),[])},g={key:"",name:"","aria-invalid":!1,className:"",onChange:C,onBlur:C,ref:C,value:"",checked:!1},Be=({defaultValues:r,mode:s,classNameError:o,shouldFocusError:c=!1,resolver:i=C})=>{const[y,m]=u.useState({values:r||D,errors:{}}),{values:v,errors:_}=y,w=u.useRef(!1),G=u.useRef(!1),L=u.useRef(!1),O=u.useRef(new Map),ie=u.useRef(),Q=s==="onSubmit",ae=s==="onBlur",ue=s==="onChange",je=!Q&&!ae&&!ue,T=e=>m(t=>q(k({},t),{errors:e})),X=u.useCallback(e=>{const t=e||D;ie.current=ee(t),m(n=>q(k({},n),{values:k({},t)}))},[]);u.useEffect(()=>(X(r),Oe),[r,X]);const Z=e=>{const t=O.current.get(e);return t&&t.focus?(t.focus(),!0):!1},A=p((e="")=>(O.current.has(e)||O.current.set(e,null),R(e,v))),V=p((e="",t=_)=>R(e,t)),S=p((e="",t=_)=>e===""?re(t).length>0:R(e,t)!==void 0),fe=p((e,t=_)=>{let n=t;return S(e,t)&&(n=j(e,t)),n}),de=p((e="",t=v)=>new Promise((n=C)=>{const a=i(t);if(e===""){T(a),n(a);return}const f=x(e)?e:[e];let d=k({},_);f.forEach(h=>{const F=R(h,a);d=j(h,d),F!==void 0&&(d=N(h,d,F))}),T(d),n(d)})),pe=ue||L.current&&je,Je=pe&&!Q,le=p((e,t)=>{let n=_;if((pe||S(e))&&(n=j(e,n),!Q)){const a=R(e,i(t));a&&(n=N(e,n,a))}return n}),b=p((e,t,n=le)=>new Promise((a=C)=>{m(f=>{const d=N(e,f.values,t);w.current=!0,G.current=ie.current!==ee(d);const h=n(e,d),F={values:d,errors:h};return a(F),F})})),B=p((e,t,n)=>Je&&t?le:()=>{let a=_;const f=V(e);if(x(f)){const d=n(f);d===null?a=j(e,a):(f.message&&(d.message=f.message,d.type=f.type),a=N(e,_,d))}return a}),Le=p((e,t=!1)=>b(e,[],B(e,t,n=>n.message?[]:null))),Ve=p((e,t,n=!1)=>b(e,[...A(e),t],B(e,n,a=>a))),ze=p((e,t,n=!1)=>b(e,[t,...A(e)],B(e,n,a=>[void 0,...a]))),Ke=p((e,t,n=!1)=>b(e,A(e).filter((a,f)=>f!==t),B(e,n,a=>{const f=a.filter((d,h)=>h!==t);return f.length===0&&!a.message?null:f}))),Ue=p((e,t,n,a=!1)=>b(e,ne(A(e),t,n),B(e,a,f=>ne(f,t,n)))),We=p(e=>O.current.get(e)),me=p((e,t)=>{t&&O.current.set(e,t)}),Ye=p(e=>e&&me(e.name,e)),ye=p(e=>b(e.target.name,be(e))),_e=p(e=>{const{name:t}=e.target,n=R(t,i(v));n?(T(N(t,_,n)),c&&Z(t)):T(fe(t))}),He=p((e,t="")=>{const n=A(e),a=S(e);return g.name=e,g["aria-invalid"]=a,g.className=Y(D,a?o:"",t),g.onChange=ye,g.ref=Ye,g.onBlur=ae?_e:void 0,n===!0||n===!1?(g.checked=n,g.value=void 0):(g.value=`${n}`=="0"?n:n||"",g.checked=void 0),g}),Ge=p((e=r,t=!0)=>{X(e),w.current=!1,G.current=!1,t&&de("",e)}),Qe=e=>t=>{t&&t.preventDefault();const n=i(v);if(T(n),S("",n)){if(c){let a=!1;O.current.forEach((f,d)=>{!a&&S(d,n)&&(a=Z(d))})}return L.current=!0,!1}return e(v),!0},Xe=p(({for:e,children:t})=>{const n=V(e,_);return!n||!n.message?!1:P(t)?t(n):H("span",{className:Y(n,o),children:n.message})}),Ee=!S(),Ze=p(({children:e,focusable:t=!1})=>{if(Ee)return!1;const a=Array.from(O.current).filter(f=>!!f[1]).map(f=>f[0]).filter(f=>S(f,_)).sort().map(f=>{const d=V(f);return H("li",{className:Y(d,o),children:t?H("a",{onClick:()=>Z(f),children:d.message}):d.message},f)});return P(e)?e(a):a});return{getValue:A,setValue:b,register:He,onChange:ye,onBlur:_e,getRef:We,setRef:me,trigger:de,handleSubmit:Qe,hasError:S,getError:V,clearError:e=>T(fe(e)),setErrors:e=>{L.current=!0,T(e)},array:{clear:Le,append:Ve,prepend:ze,remove:Ke,swap:Ue},key:ke,reset:Ge,Error:Xe,Errors:Ze,formState:{errors:_,isValid:Ee,isTouched:w.current,isDirty:G.current,hadError:L.current}}},Fe=r=>s=>{let o={};try{r.validateSync(s,{abortEarly:!1})}catch(c){for(const i of c.inner){const y=R(i.path,o)||{};y.message=i.message,y.type=i.type,o=N(i.path,o,y)}}return o},Ie=r=>s=>{let o={};const c=r.safeParse(s);return c.success||c.error.errors.forEach(i=>{const y=i.path.join("."),m=R(y,o)||{};m.message=i.message,m.type=i.type,o=N(y,o,m)}),o};l.default=Be,l.yupResolver=Fe,l.zodResolver=Ie,Object.defineProperty(l,"__esModule",{value:!0}),l[Symbol.toStringTag]="Module"});
