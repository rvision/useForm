var Qe=Object.defineProperty,Xe=Object.defineProperties;var Ze=Object.getOwnPropertyDescriptors;var ge=Object.getOwnPropertySymbols;var qe=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable;var Ee=(l,a,g)=>a in l?Qe(l,a,{enumerable:!0,configurable:!0,writable:!0,value:g}):l[a]=g,A=(l,a)=>{for(var g in a||(a={}))qe.call(a,g)&&Ee(l,g,a[g]);if(ge)for(var g of ge(a))$e.call(a,g)&&Ee(l,g,a[g]);return l},L=(l,a)=>Xe(l,Ze(a));(function(l,a){typeof exports=="object"&&typeof module!="undefined"?a(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],a):(l=typeof globalThis!="undefined"?globalThis:l||self,a(l["@rvision/use-form"]={},l.react))})(this,function(l,a){"use strict";function g(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var ve=g(a);const $=e=>typeof e=="function",x={},M=()=>x;let _e=2e9;const C=new WeakMap,we=e=>{let r=C.get(e);return r||(r=(_e++).toString(36),C.set(e,r)),r},P=e=>{let r;if(e instanceof Set)r=new Set([...e]);else{const t=Array.isArray(e);r=t?[...e]:A({},e),t&&e.message&&(r.message=e.message,r.type=e.type)}return C.has(e)&&(C.set(r,C.get(e)),C.delete(e)),r},Re=/\[([^\]]+)\]/g;let z=new Map;const U=e=>{if(!e)return[];let r=z.get(e);return r||(r=e.replace(Re,".$1").split(".").map(t=>isNaN(parseInt(t,10))?t:+t),z.set(e,r),r)},Ne=()=>{z=new Map},W=(e,r)=>{if(r!==void 0)return e.length===0?r:W(e.slice(1),r[e[0]])},E=(e,r)=>W(U(e),r),ee=(e,r,t)=>{const{length:c}=e;if(c===0)return;const i=e[0];if(c===1){r[i]=t;return}const m=r[i]!==void 0,y=e[1],N=!isNaN(y);r[i]=m?P(r[i]):N?[]:{},N&&(r[i][y]=r[i][y]===void 0?{}:P(r[i][y])),ee(e.slice(1),r[i],t)},k=(e,r,t)=>{const c=A({},r);return ee(U(e),c,t),c},B=(e,r)=>{const{length:t}=e;if(t===0||r===void 0)return;const c=e[0];if(t===1){delete r[c];return}B(e.slice(1),r[c])},Y=e=>Object.keys(e||x).length===0,Ae=(e,r)=>{B(e,r),e.map((c,i)=>i===0?[...e]:[...e].slice(0,-1*i)).forEach(c=>{const i=W(c,r);i!==void 0&&(Array.isArray(i)?(i.length===0||i.every(Y))&&!i.message&&B(c,r):Y(i)&&B(c,r))})},D=(e,r)=>{const t=A({},r);return Ae(U(e),t),t},ke=e=>{const{value:r,type:t,checked:c,options:i,files:m,multiple:y,valueAsNumber:N,valueAsDate:R}=e.target;switch(t){case"checkbox":return c;case"range":return N;case"date":return R;case"number":{if(r==="")return null;const _=Number.parseFloat(r);return isNaN(_)?void 0:+_}case"file":return y?m:m.item(0);case"select-multiple":return[...i].filter(_=>_.selected).map(_=>_.value);default:return r}},Oe=(e,r,t)=>{if(Array.isArray(e)){const c=[...e];for(;c.length<r+1||c.length<t+1;)c.length++;return[c[r],c[t]]=[c[t],c[r]],c}return e},j=(e,r,t)=>`${t||""} ${r||""} ${e.type?`error-${e.type}`:""}`.trim(),Se=e=>r=>{let t={};try{e.validateSync(r,{abortEarly:!1})}catch(c){for(const i of c.inner){const m=E(i.path,t)||{};m.message=i.message,m.type=i.type,t=k(i.path,t,m)}}return t},he=e=>r=>{let t={};const c=e.safeParse(r);return c.success||c.error.errors.forEach(i=>{const m=i.path.join("."),y=E(m,t)||{};y.message=i.message,y.type=i.type,t=k(m,t,y)}),t};var re={exports:{}},F={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Te=ve.default,Ce=Symbol.for("react.element"),xe=Symbol.for("react.fragment"),Me=Object.prototype.hasOwnProperty,Ie=Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,be={key:!0,ref:!0,__self:!0,__source:!0};function se(e,r,t){var c,i={},m=null,y=null;t!==void 0&&(m=""+t),r.key!==void 0&&(m=""+r.key),r.ref!==void 0&&(y=r.ref);for(c in r)Me.call(r,c)&&!be.hasOwnProperty(c)&&(i[c]=r[c]);if(e&&e.defaultProps)for(c in r=e.defaultProps,r)i[c]===void 0&&(i[c]=r[c]);return{$$typeof:Ce,type:e,key:m,ref:y,props:i,_owner:Ie.current}}F.Fragment=xe,F.jsx=se,F.jsxs=se,re.exports=F;const H=re.exports.jsx,ne="aria-invalid",K=e=>JSON.stringify(e,(r,t)=>t instanceof Set?[...t].sort():t),d=e=>{const r=a.useRef(e);return r.current=e,a.useCallback((...t)=>r.current(...t),[])},v={name:"",[ne]:!1,className:"",onChange:M,onBlur:M,ref:M,value:"",checked:!1},Be=({defaultValues:e,mode:r,classNameError:t,shouldFocusError:c=!1,resolver:i=M})=>{const[m,y]=a.useState({values:e||x,errors:{}}),{values:N,errors:R}=m,_=a.useRef(!1),V=a.useRef(!1),J=a.useRef(!1),h=a.useRef(new Map),G=a.useRef(),te=r==="onSubmit",oe=r==="onBlur",ce=r==="onChange",De=!te&&!oe&&!ce,I=s=>y(n=>L(A({},n),{errors:s})),Q=a.useCallback(s=>{const n=s||x;G.current=K(n),y(o=>L(A({},o),{values:A({},n)}))},[]);a.useEffect(()=>(Q(e),Ne),[e,Q]);const X=a.useCallback(s=>{const n=h.current.get(s);return n&&n.focus?(n.focus(),!0):!1},[]),ie=d((s="")=>(h.current.has(s)||h.current.set(s,null),E(s,N))),Z=d((s="",n=R)=>E(s,n)),O=d((s="",n=R)=>s===""?!Y(n):E(s,n)!==void 0),ae=d((s,n=R)=>{let o=n;return O(s,n)&&(o=D(s,n)),o}),ue=d((s="")=>new Promise((n=M)=>{y(o=>{let u=i(o.values);if(s!==""){const p=Array.isArray(s)?s:[s];let S=A({},o.errors);p.forEach(w=>{const T=E(w,u);S=D(w,S),T!==void 0&&(S=k(w,S,T))}),u=S}const f=L(A({},o),{errors:u});return n(f),f})})),fe=ce||J.current&&De,de=d((s,n)=>y(o=>{const u=s===""?n:k(s,o.values,n);_.current=!0,V.current=G.current!==K(u);let f=R;if((fe||O(s))&&(f=D(s,f),!te)){const p=E(s,i(u));p&&(f=k(s,f,p))}return{values:u,errors:f}})),b=d((s,n,o)=>{y(u=>{const f=k(s,u.values,n(E(s,u.values)));_.current=!0,V.current=G.current!==K(f);let p=u.errors;const S=E(s,p);let w=[];if(Array.isArray(S)&&(w=o(S)),fe){const T=E(s,i(f));if(T&&T.message){const q=w.length>0?w:{};q.message=T.message,q.type=T.type,w=q}}return p=D(s,p),(w.length>0||w.message)&&(p=k(s,p,w)),{values:f,errors:p}})}),Fe=d((s,n)=>{b(s,o=>[...o,n],o=>o)}),Ve=d((s,n)=>{b(s,o=>[n,...o],o=>[void 0,...o])}),Je=d(s=>{const n=()=>[];b(s,n,n)}),Le=d((s,n)=>{const o=u=>[...u].filter((f,p)=>p!==n);b(s,o,o)}),ze=d((s,n,o)=>{const u=f=>Oe(f,n,o);b(s,u,u)}),Ue=d(s=>h.current.get(s)),le=d((s,n)=>{n&&h.current.set(s,n)}),We=d(s=>s&&le(s.name,s)),pe=d(s=>de(s.target.name,ke(s))),ye=d(s=>{const{name:n}=s.target,o=E(n,i(N));o?(I(k(n,R,o)),c&&X(n)):I(ae(n))}),Ye=d((s,n="")=>{const o=ie(s),u=O(s);return v.name=s,v[ne]=u,v.className=j(x,u?t:"",n),v.onChange=pe,v.ref=We,v.onBlur=oe?ye:void 0,o===!0||o===!1?(v.checked=o,v.value=void 0):(v.value=`${o}`=="0"?o:o||"",v.checked=void 0),v}),je=d((s=e,n=!0)=>{Q(s),_.current=!1,V.current=!1,n&&ue("",s)}),He=s=>n=>{n&&n.preventDefault();const o=i(N);if(I(o),O("",o)){if(c){let u=!1;h.current.forEach((f,p)=>{!u&&O(p,o)&&(u=X(p))})}return J.current=!0,!1}return s(N),!0},Ke=d(({for:s,children:n})=>{const o=Z(s,R);return(o==null?void 0:o.message)?$(n)?n(o):H("span",{className:j(o,t),children:o.message}):!1}),me=!O(),Ge=d(({children:s,focusable:n=!1})=>{if(me)return!1;const u=Array.from(h.current).map(f=>f[0]).filter(f=>O(f,R)).sort().map(f=>{const p=Z(f);return H("li",{className:j(p,t),children:n?H("a",{onClick:()=>X(f),children:p.message}):p.message},f)});return $(s)?s(u):u});return{getValue:ie,setValue:de,register:Ye,onChange:pe,onBlur:ye,getRef:Ue,setRef:le,trigger:ue,handleSubmit:He,hasError:O,getError:Z,clearError:s=>I(ae(s)),setErrors:s=>{J.current=!0,I(s)},array:{clear:Je,append:Fe,prepend:Ve,remove:Le,swap:ze},key:we,Error:Ke,Errors:Ge,formState:{errors:R,isValid:me,isTouched:_.current,isDirty:V.current,hadError:J.current,reset:je}}};l.default=Be,l.yupResolver=Se,l.zodResolver=he,Object.defineProperty(l,"__esModule",{value:!0}),l[Symbol.toStringTag]="Module"});
