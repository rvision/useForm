var Ge=Object.defineProperty,Qe=Object.defineProperties;var Xe=Object.getOwnPropertyDescriptors;var me=Object.getOwnPropertySymbols;var Ze=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable;var ge=(d,i,g)=>i in d?Ge(d,i,{enumerable:!0,configurable:!0,writable:!0,value:g}):d[i]=g,A=(d,i)=>{for(var g in i||(i={}))Ze.call(i,g)&&ge(d,g,i[g]);if(me)for(var g of me(i))qe.call(i,g)&&ge(d,g,i[g]);return d},J=(d,i)=>Qe(d,Xe(i));(function(d,i){typeof exports=="object"&&typeof module!="undefined"?i(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],i):(d=typeof globalThis!="undefined"?globalThis:d||self,i(d["@rvision/use-form"]={},d.react))})(this,function(d,i){"use strict";function g(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Ee=g(i);const $=e=>typeof e=="function",b={},x=()=>b;let ve=2e9;const T=new WeakMap,_e=e=>{let s=T.get(e);return s||(s=(ve++).toString(36),T.set(e,s)),s},P=e=>{let s;if(e instanceof Set)s=new Set([...e]);else{const t=Array.isArray(e);s=t?[...e]:A({},e),t&&e.message&&(s.message=e.message,s.type=e.type)}return T.has(e)&&(T.set(s,T.get(e)),T.delete(e)),s},we=/\[([^\]]+)\]/g;let z=new Map;const U=e=>{if(!e)return[];let s=z.get(e);return s||(s=e.replace(we,".$1").split(".").map(t=>isNaN(parseInt(t,10))?t:+t),z.set(e,s),s)},Ne=()=>{z=new Map},W=(e,s)=>{if(s!==void 0)return e.length===0?s:W(e.slice(1),s[e[0]])},v=(e,s)=>W(U(e),s),ee=(e,s,t)=>{const{length:c}=e;if(c===0)return;const a=e[0];if(c===1){s[a]=t;return}const y=s[a]!==void 0,p=e[1],R=!isNaN(p);s[a]=y?P(s[a]):R?[]:{},R&&(s[a][p]=s[a][p]===void 0?{}:P(s[a][p])),ee(e.slice(1),s[a],t)},O=(e,s,t)=>{const c=A({},s);return ee(U(e),c,t),c},B=(e,s)=>{const{length:t}=e;if(t===0||s===void 0)return;const c=e[0];if(t===1){delete s[c];return}B(e.slice(1),s[c])},Y=e=>Object.keys(e||b).length===0,Re=(e,s)=>{B(e,s),e.map((c,a)=>a===0?[...e]:[...e].slice(0,-1*a)).forEach(c=>{const a=W(c,s);a!==void 0&&(Array.isArray(a)?(a.length===0||a.every(Y))&&!a.message&&B(c,s):Y(a)&&B(c,s))})},D=(e,s)=>{const t=A({},s);return Re(U(e),t),t},ke=e=>{const{value:s,type:t,checked:c,options:a,files:y,multiple:p,valueAsNumber:R,valueAsDate:m}=e.target;switch(t){case"checkbox":return c;case"range":return R;case"date":return m;case"number":{if(s==="")return null;const w=Number.parseFloat(s);return isNaN(w)?void 0:+w}case"file":return p?y:y.item(0);case"select-multiple":return[...a].filter(w=>w.selected).map(w=>w.value);default:return s}},Ae=(e,s,t)=>{if(Array.isArray(e)){const c=[...e];for(;c.length<s+1||c.length<t+1;)c.length++;return[c[s],c[t]]=[c[t],c[s]],c}return e},j=(e,s,t)=>`${t||""} ${s||""} ${e.type?`error-${e.type}`:""}`.trim(),Oe=e=>s=>{let t={};try{e.validateSync(s,{abortEarly:!1})}catch(c){for(const a of c.inner){const y=v(a.path,t)||{};y.message=a.message,y.type=a.type,t=O(a.path,t,y)}}return t},Se=e=>s=>{let t={};const c=e.safeParse(s);return c.success||c.error.errors.forEach(a=>{const y=a.path.join("."),p=v(y,t)||{};p.message=a.message,p.type=a.type,t=O(y,t,p)}),t};var se={exports:{}},F={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var he=Ee.default,Ce=Symbol.for("react.element"),Te=Symbol.for("react.fragment"),be=Object.prototype.hasOwnProperty,xe=he.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ie={key:!0,ref:!0,__self:!0,__source:!0};function re(e,s,t){var c,a={},y=null,p=null;t!==void 0&&(y=""+t),s.key!==void 0&&(y=""+s.key),s.ref!==void 0&&(p=s.ref);for(c in s)be.call(s,c)&&!Ie.hasOwnProperty(c)&&(a[c]=s[c]);if(e&&e.defaultProps)for(c in s=e.defaultProps,s)a[c]===void 0&&(a[c]=s[c]);return{$$typeof:Ce,type:e,key:y,ref:p,props:a,_owner:xe.current}}F.Fragment=Te,F.jsx=re,F.jsxs=re,se.exports=F;const H=se.exports.jsx,ne="aria-invalid",K=e=>JSON.stringify(e,(s,t)=>t instanceof Set?[...t].sort():t),E=e=>{const s=i.useRef(e);return i.useLayoutEffect(()=>{s.current=e}),i.useCallback((...t)=>s.current(...t),[])},_={name:"",[ne]:!1,className:"",onChange:x,onBlur:x,ref:x,value:"",checked:!1},Me=({defaultValues:e,mode:s,classNameError:t,shouldFocusError:c=!1,resolver:a=x})=>{const[y,p]=i.useState({values:e||b,errors:{}}),{values:R,errors:m}=y,w=i.useRef(!1),L=i.useRef(!1),V=i.useRef(!1),h=i.useRef(new Map),G=i.useRef(),te=s==="onSubmit",oe=s==="onBlur",ce=s==="onChange",Be=!te&&!oe&&!ce,I=r=>p(n=>J(A({},n),{errors:r})),Q=i.useCallback(r=>{const n=r||b;G.current=K(n),p(o=>J(A({},o),{values:A({},n)}))},[]);i.useEffect(()=>(Q(e),Ne),[e,Q]);const X=i.useCallback(r=>{const n=h.current.get(r);return n&&n.focus?(n.focus(),!0):!1},[]),ae=(r="")=>(h.current.has(r)||h.current.set(r,null),v(r,R)),Z=i.useCallback((r="",n=m)=>v(r,n),[m]),k=i.useCallback((r="",n=m)=>r===""?!Y(n):v(r,n)!==void 0,[m]),ie=E((r,n=m)=>{let o=n;return k(r,n)&&(o=D(r,n)),o}),ue=E((r="")=>new Promise((n=x)=>{p(o=>{let f=a(o.values);if(r!==""){const l=Array.isArray(r)?r:[r];let S=A({},o.errors);l.forEach(N=>{const C=v(N,f);S=D(N,S),C!==void 0&&(S=O(N,S,C))}),f=S}const u=J(A({},o),{errors:f});return n(u),u})})),fe=ce||V.current&&Be,le=E((r,n)=>p(o=>{const f=O(r,o.values,n);w.current=!0,L.current=G.current!==K(f);let u=m;if((fe||k(r))&&(u=D(r,u),!te)){const l=v(r,a(f));l&&(u=O(r,u,l))}return{values:f,errors:u}})),M=E((r,n,o)=>{p(f=>{const u=O(r,f.values,n(v(r,f.values)));w.current=!0,L.current=G.current!==K(u);let l=f.errors;const S=v(r,l);let N=[];if(Array.isArray(S)&&(N=o(S)),fe){const C=v(r,a(u));if(C&&C.message){const q=N.length>0?N:{};q.message=C.message,q.type=C.type,N=q}}return l=D(r,l),(N.length>0||N.message)&&(l=O(r,l,N)),{values:u,errors:l}})}),De=E((r,n)=>{M(r,o=>[...o,n],o=>o)}),Fe=E((r,n)=>{M(r,o=>[n,...o],o=>[void 0,...o])}),Le=E(r=>{const n=()=>[];M(r,n,n)}),Ve=E((r,n)=>{const o=f=>[...f].filter((u,l)=>l!==n);M(r,o,o)}),Je=E((r,n,o)=>{const f=u=>Ae(u,n,o);M(r,f,f)}),ze=r=>h.current.get(r),de=(r,n)=>{n&&h.current.set(r,n)},Ue=r=>r&&de(r.name,r),pe=E(r=>le(r.target.name,ke(r))),ye=E(r=>{const{name:n}=r.target,o=v(n,a(R));o?(I(O(n,m,o)),c&&X(n)):I(ie(n))}),We=(r,n="")=>{const o=ae(r),f=k(r);return _.name=r,_[ne]=f,_.className=j(b,f?t:"",n),_.onChange=pe,_.ref=Ue,_.onBlur=oe?ye:void 0,o===!0||o===!1?(_.checked=o,_.value=void 0):(_.value=`${o}`=="0"?o:o||"",_.checked=void 0),_},Ye=E((r=e,n=!0)=>{Q(r),w.current=!1,L.current=!1,n&&ue("",r)}),je=r=>n=>{n&&n.preventDefault();const o=a(R);if(I(o),k("",o)){if(c){let f=!1;h.current.forEach((u,l)=>{!f&&k(l,o)&&(f=X(l))})}return V.current=!0,!1}return r(R),!0},He=i.useCallback(({for:r,children:n})=>{const o=Z(r,m);return(o==null?void 0:o.message)?$(n)?n(o):H("span",{className:j(o,t),children:o.message}):!1},[m]),Ke=i.useCallback(({children:r,focusable:n=!1})=>{if(!k())return!1;const f=Array.from(h.current).filter(u=>!!u[1]).map(u=>u[0]).filter(u=>k(u,m)).sort().map(u=>{const l=Z(u);return H("li",{className:j(l,t),children:n?H("a",{onClick:()=>X(u),children:l==null?void 0:l.message}):l==null?void 0:l.message},u)});return $(r)?r(f):f},[m]);return{getValue:ae,setValue:le,register:We,onChange:pe,onBlur:ye,getRef:ze,setRef:de,trigger:ue,handleSubmit:je,hasError:k,getError:Z,clearError:r=>I(ie(r)),setErrors:r=>{V.current=!0,I(r)},array:{clear:Le,append:De,prepend:Fe,remove:Ve,swap:Je},key:_e,Error:He,Errors:Ke,formState:{errors:m,isValid:!k(),isTouched:w.current,isDirty:L.current,hadError:V.current,reset:Ye}}};d.default=Me,d.yupResolver=Oe,d.zodResolver=Se,Object.defineProperty(d,"__esModule",{value:!0}),d[Symbol.toStringTag]="Module"});
