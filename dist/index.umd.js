var qe=Object.defineProperty,$e=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var _e=Object.getOwnPropertySymbols;var er=Object.prototype.hasOwnProperty,rr=Object.prototype.propertyIsEnumerable;var we=(p,u,v)=>u in p?qe(p,u,{enumerable:!0,configurable:!0,writable:!0,value:v}):p[u]=v,k=(p,u)=>{for(var v in u||(u={}))er.call(u,v)&&we(p,v,u[v]);if(_e)for(var v of _e(u))rr.call(u,v)&&we(p,v,u[v]);return p},U=(p,u)=>$e(p,Pe(u));(function(p,u){typeof exports=="object"&&typeof module!="undefined"?u(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],u):(p=typeof globalThis!="undefined"?globalThis:p||self,u(p["@rvision/use-form"]={},p.react))})(this,function(p,u){"use strict";function v(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Re=v(u);const re=e=>typeof e=="function",b={},I=()=>b;let Ae=2e9;const x=new WeakMap,ke=e=>{let r=x.get(e);return r||(r=(Ae++).toString(36),x.set(e,r)),r},se=e=>{let r;if(e instanceof Set)r=new Set([...e]);else{const t=Array.isArray(e);r=t?[...e]:k({},e),t&&e.message&&(r.message=e.message,r.type=e.type)}return x.has(e)&&(x.set(r,x.get(e)),x.delete(e)),r},Ne=/\[([^\]]+)\]/g;let W=new Map;const Y=e=>{if(!e)return[];let r=W.get(e);return r||(r=e.replace(Ne,".$1").split(".").map(t=>+t-+t===0?+t:t),W.set(e,r),r)},Oe=()=>{W=new Map},j=(e,r)=>{if(r!==void 0)return e.length===0?r:j(e.slice(1),r[e[0]])},_=(e,r)=>j(Y(e),r),ne=(e,r,t)=>{const{length:c}=e;if(c===0)return;const a=e[0];if(c===1){r[a]=t;return}const l=r[a]!==void 0,g=e[1],A=+g-+g<1;r[a]=l?se(r[a]):A?[]:{},A&&(r[a][g]=r[a][g]===void 0?{}:se(r[a][g])),ne(e.slice(1),r[a],t)},N=(e,r,t)=>{const c=k({},r);return ne(Y(e),c,t),c},D=(e,r)=>{const{length:t}=e;if(t===0||r===void 0)return;const c=e[0];if(t===1){delete r[c];return}D(e.slice(1),r[c])},H=e=>Object.keys(e||b).length===0,Se=(e,r)=>{D(e,r),e.map((c,a)=>a===0?[...e]:[...e].slice(0,-1*a)).forEach(c=>{const a=j(c,r);a!==void 0&&(Array.isArray(a)?(a.length===0||a.every(H))&&!a.message&&D(c,r):H(a)&&D(c,r))})},F=(e,r)=>{const t=k({},r);return Se(Y(e),t),t},Te=e=>{const{value:r,type:t,checked:c,options:a,files:l,multiple:g,valueAsNumber:A,valueAsDate:M}=e.target;switch(t){case"checkbox":return c;case"range":return A;case"date":return M;case"number":{if(r==="")return null;const E=Number.parseFloat(r);return+E-+E<1?+E:void 0}case"file":return g?l:l.item(0);case"select-multiple":return[...a].filter(E=>E.selected).map(E=>E.value);default:return r}},Ce=(e,r,t)=>{if(Array.isArray(e)){const c=[...e];for(;c.length<r+1||c.length<t+1;)c.length++;return[c[r],c[t]]=[c[t],c[r]],c}return e},K=(e,r,t)=>`${t||""} ${r||""} ${e.type?`error-${e.type}`:""}`.trim(),xe=e=>r=>{let t={};try{e.validateSync(r,{abortEarly:!1})}catch(c){for(const a of c.inner){const l=_(a.path,t)||{};l.message=a.message,l.type=a.type,t=N(a.path,t,l)}}return t},Me=e=>r=>{let t={};const c=e.safeParse(r);return c.success||c.error.errors.forEach(a=>{const l=a.path.join("."),g=_(l,t)||{};g.message=a.message,g.type=a.type,t=N(l,t,g)}),t};var te={exports:{}},V={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var be=Re.default,Ie=Symbol.for("react.element"),he=Symbol.for("react.fragment"),Be=Object.prototype.hasOwnProperty,De=be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Fe={key:!0,ref:!0,__self:!0,__source:!0};function oe(e,r,t){var c,a={},l=null,g=null;t!==void 0&&(l=""+t),r.key!==void 0&&(l=""+r.key),r.ref!==void 0&&(g=r.ref);for(c in r)Be.call(r,c)&&!Fe.hasOwnProperty(c)&&(a[c]=r[c]);if(e&&e.defaultProps)for(c in r=e.defaultProps,r)a[c]===void 0&&(a[c]=r[c]);return{$$typeof:Ie,type:e,key:l,ref:g,props:a,_owner:De.current}}V.Fragment=he,V.jsx=oe,V.jsxs=oe,te.exports=V;const G=te.exports.jsx,ce="aria-invalid",Q=e=>JSON.stringify(e,(r,t)=>t instanceof Set?[...t].sort():t),X=new Map,d=(e,r)=>(X.set(e,r),u.useEffect(()=>()=>X.delete(e),[e]),u.useCallback((...t)=>X.get(e)(...t),[e])),w={name:"",[ce]:!1,className:"",onChange:I,onBlur:I,ref:I,value:"",checked:!1},Ve=({id:e="",defaultValues:r,mode:t,classNameError:c,shouldFocusError:a=!1,resolver:l=I})=>{const[g,A]=u.useState({values:r||b,errors:{}}),{values:M,errors:E}=g,J=u.useRef(!1),L=u.useRef(!1),z=u.useRef(!1),T=u.useRef(new Map),Z=u.useRef(),ae=t==="onSubmit",ue=t==="onBlur",ie=t==="onChange",Je=!ae&&!ue&&!ie;let y=1;const h=s=>A(n=>U(k({},n),{errors:s})),q=u.useCallback(s=>{const n=s||b;Z.current=Q(n),A(o=>U(k({},o),{values:k({},n)}))},[]);u.useEffect(()=>(q(r),()=>{Oe()}),[r,q]);const $=u.useCallback(s=>{const n=T.current.get(s);return n&&n.focus?(n.focus(),!0):!1},[]),fe=d(e+y++,(s="")=>(T.current.has(s)||T.current.set(s,null),_(s,M))),P=d(e+y++,(s="",n=E)=>_(s,n)),O=d(e+y++,(s="",n=E)=>s===""?!H(n):_(s,n)!==void 0),le=d(e+y++,(s,n=E)=>{let o=n;return O(s,n)&&(o=F(s,n)),o}),pe=d(e+y++,(s="")=>new Promise((n=I)=>{A(o=>{let i=l(o.values);if(s!==""){const m=Array.isArray(s)?s:[s];let S=k({},o.errors);m.forEach(R=>{const C=_(R,i);S=F(R,S),C!==void 0&&(S=N(R,S,C))}),i=S}const f=U(k({},o),{errors:i});return n(f),f})})),de=ie||z.current&&Je,ye=d(e+y++,(s,n)=>A(o=>{const i=N(s,o.values,n);J.current=!0,L.current=Z.current!==Q(i);let f=E;if((de||O(s))&&(f=F(s,f),!ae)){const m=_(s,l(i));m&&(f=N(s,f,m))}return{values:i,errors:f}})),B=d(e+y++,(s,n,o)=>{A(i=>{const f=N(s,i.values,n(_(s,i.values)));J.current=!0,L.current=Z.current!==Q(f);let m=i.errors;const S=_(s,m);let R=[];if(Array.isArray(S)&&(R=o(S)),de){const C=_(s,l(f));if(C&&C.message){const ee=R.length>0?R:{};ee.message=C.message,ee.type=C.type,R=ee}}return m=F(s,m),(R.length>0||R.message)&&(m=N(s,m,R)),{values:f,errors:m}})}),Le=d(e+y++,(s,n)=>{B(s,o=>[...o,n],o=>o)}),ze=d(e+y++,(s,n)=>{B(s,o=>[n,...o],o=>[void 0,...o])}),Ue=d(e+y++,s=>{const n=()=>[];B(s,n,n)}),We=d(e+y++,(s,n)=>{const o=i=>[...i].filter((f,m)=>m!==n);B(s,o,o)}),Ye=d(e+y++,(s,n,o)=>{const i=f=>Ce(f,n,o);B(s,i,i)}),je=d(e+y++,s=>T.current.get(s)),me=d(e+y++,(s,n)=>{n&&T.current.set(s,n)}),He=s=>s&&me(s.name,s),ge=d(e+y++,s=>ye(s.target.name,Te(s))),Ee=d(e+y++,s=>{const{name:n}=s.target,o=_(n,l(M));o?(h(N(n,E,o)),a&&$(n)):h(le(n))}),Ke=d(e+y++,(s,n="")=>{const o=fe(s),i=O(s);return w.name=s,w[ce]=i,w.className=K(b,i?c:"",n),w.onChange=ge,w.ref=He,w.onBlur=ue?Ee:void 0,o===!0||o===!1?(w.checked=o,w.value=void 0):(w.value=`${o}`=="0"?o:o||"",w.checked=void 0),w}),Ge=d(e+y++,(s=r,n=!0)=>{q(s),J.current=!1,L.current=!1,n&&pe("",s)}),Qe=s=>n=>{n&&n.preventDefault();const o=l(M);if(h(o),O("",o)){if(a){let i=!1;T.current.forEach((f,m)=>{!i&&O(m,o)&&(i=$(m))})}return z.current=!0,!1}return s(M),!0},Xe=d(e+y++,({for:s,children:n})=>{const o=P(s,E);return(o==null?void 0:o.message)?re(n)?n(o):G("span",{className:K(o,c),children:o.message}):!1}),ve=!O(),Ze=d(e+y++,({children:s,focusable:n=!1})=>{if(ve)return!1;const i=Array.from(T.current).map(f=>f[0]).filter(f=>O(f,E)).sort().map(f=>{const m=P(f);return G("li",{className:K(m,c),children:n?G("a",{onClick:()=>$(f),children:m.message}):m.message},f)});return re(s)?s(i):i});return{getValue:fe,setValue:ye,register:Ke,onChange:ge,onBlur:Ee,getRef:je,setRef:me,trigger:pe,handleSubmit:Qe,hasError:O,getError:P,clearError:s=>h(le(s)),setErrors:s=>{z.current=!0,h(s)},array:{clear:Ue,append:Le,prepend:ze,remove:We,swap:Ye},key:ke,Error:Xe,Errors:Ze,formState:{errors:E,isValid:ve,isTouched:J.current,isDirty:L.current,hadError:z.current,reset:Ge}}};p.default=Ve,p.yupResolver=xe,p.zodResolver=Me,Object.defineProperty(p,"__esModule",{value:!0}),p[Symbol.toStringTag]="Module"});
