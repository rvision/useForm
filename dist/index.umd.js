var Xe=Object.defineProperty,Ze=Object.defineProperties;var qe=Object.getOwnPropertyDescriptors;var me=Object.getOwnPropertySymbols;var $e=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable;var ge=(l,a,g)=>a in l?Xe(l,a,{enumerable:!0,configurable:!0,writable:!0,value:g}):l[a]=g,A=(l,a)=>{for(var g in a||(a={}))$e.call(a,g)&&ge(l,g,a[g]);if(me)for(var g of me(a))Pe.call(a,g)&&ge(l,g,a[g]);return l},L=(l,a)=>Ze(l,qe(a));(function(l,a){typeof exports=="object"&&typeof module!="undefined"?a(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],a):(l=typeof globalThis!="undefined"?globalThis:l||self,a(l["@rvision/use-form"]={},l.react))})(this,function(l,a){"use strict";function g(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var ve=g(a);const $=e=>typeof e=="function",x={},C=()=>x;let Ee=1e9;const h=new WeakMap,we=e=>{let s=h.get(e);return s||(s=(++Ee).toString(36).split("").reduce((o,c)=>c+o,""),h.set(e,s)),s},P=e=>{let s;return e instanceof Set?s=new Set([...e]):s=Array.isArray(e)?[...e]:A({},e),h.has(e)&&(h.set(s,h.get(e)),h.delete(e)),s},_e=/\[([^\]]+)\]/g;let j=new Map;const z=e=>{if(!e)return[];let s=j.get(e);return s||(s=e.replace(_e,".$1").split(".").map(o=>isNaN(parseInt(o,10))?o:+o),j.set(e,s),s)},Re=()=>{j=new Map},U=(e,s)=>{if(s!==void 0)return e.length===0?s:U(e.slice(1),s[e[0]])},_=(e,s)=>U(z(e),s),ee=(e,s,o)=>{const{length:c}=e;if(c===0)return;const i=e[0];if(c===1){s[i]=o;return}const y=s[i]!==void 0,p=e[1],N=!isNaN(p);s[i]=y?P(s[i]):N?[]:{},N&&(s[i][p]=s[i][p]===void 0?{}:P(s[i][p])),ee(e.slice(1),s[i],o)},k=(e,s,o)=>{const c=A({},s);return ee(z(e),c,o),c},I=(e,s)=>{const{length:o}=e;if(o===0||s===void 0)return;const c=e[0];if(o===1){delete s[c];return}I(e.slice(1),s[c])},W=e=>Object.keys(e||x).length===0,Ne=(e,s)=>{I(e,s),e.map((c,i)=>i===0?[...e]:[...e].slice(0,-1*i)).forEach(c=>{const i=U(c,s);i!==void 0&&(Array.isArray(i)?(i.length===0||i.every(W))&&!i.message&&I(c,s):W(i)&&I(c,s))})},B=(e,s)=>{const o=A({},s);return Ne(z(e),o),o},Se=e=>{const{value:s,type:o,checked:c,options:i,files:y,multiple:p,valueAsNumber:N,valueAsDate:R}=e.target;switch(o){case"checkbox":return c;case"range":return N;case"date":return R;case"number":{if(s==="")return null;const E=Number.parseFloat(s);return isNaN(E)?void 0:+E}case"file":return p?y:y.item(0);case"select-multiple":return[...i].filter(E=>E.selected).map(E=>E.value);default:return s}},Ae=(e,s,o)=>{if(Array.isArray(e)){const c=[...e];return[c[s],c[o]]=[c[o],c[s]],c}return e},Y=(e,s,o)=>`${o||""} ${s||""} ${e.type?`error-${e.type}`:""}`.trim(),ke=e=>s=>{let o={};try{e.validateSync(s,{abortEarly:!1})}catch(c){for(const i of c.inner){const y=_(i.path,o)||{};y.message=i.message,y.type=i.type,o=k(i.path,o,y)}}return o},Oe=e=>s=>{let o={};const c=e.safeParse(s);return c.success||c.error.errors.forEach(i=>{const y=i.path.join("."),p=_(y,o)||{};p.message=i.message,p.type=i.type,o=k(y,o,p)}),o};var re={exports:{}},D={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Te=ve.default,he=Symbol.for("react.element"),xe=Symbol.for("react.fragment"),Ce=Object.prototype.hasOwnProperty,Me=Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,be={key:!0,ref:!0,__self:!0,__source:!0};function se(e,s,o){var c,i={},y=null,p=null;o!==void 0&&(y=""+o),s.key!==void 0&&(y=""+s.key),s.ref!==void 0&&(p=s.ref);for(c in s)Ce.call(s,c)&&!be.hasOwnProperty(c)&&(i[c]=s[c]);if(e&&e.defaultProps)for(c in s=e.defaultProps,s)i[c]===void 0&&(i[c]=s[c]);return{$$typeof:he,type:e,key:y,ref:p,props:i,_owner:Me.current}}D.Fragment=xe,D.jsx=se,D.jsxs=se,re.exports=D;const H=re.exports.jsx,ne="aria-invalid",K=e=>JSON.stringify(e,(s,o)=>o instanceof Set?[...o].sort():o),f=e=>{const s=a.useRef(e);return s.current=e,a.useCallback((...o)=>s.current(...o),[])},v={name:"",[ne]:!1,className:"",onChange:C,onBlur:C,ref:C,value:"",checked:!1},Ie=({defaultValues:e,mode:s,classNameError:o,shouldFocusError:c=!1,resolver:i=C})=>{const[y,p]=a.useState({values:e||x,errors:{}}),{values:N,errors:R}=y,E=a.useRef(!1),F=a.useRef(!1),V=a.useRef(!1),T=a.useRef(new Map),G=a.useRef(),te=s==="onSubmit",oe=s==="onBlur",ce=s==="onChange",Be=!te&&!oe&&!ce,M=r=>p(n=>L(A({},n),{errors:r})),Q=a.useCallback(r=>{const n=r||x;G.current=K(n),p(t=>L(A({},t),{values:A({},n)}))},[]);a.useEffect(()=>(Q(e),Re),[e,Q]);const X=r=>{const n=T.current.get(r);return n&&n.focus?(n.focus(),!0):!1},ie=f((r="")=>(T.current.has(r)||T.current.set(r,null),_(r,N))),Z=f((r="",n=R)=>_(r,n)),O=f((r="",n=R)=>r===""?!W(n):_(r,n)!==void 0),ae=f((r,n=R)=>{let t=n;return O(r,n)&&(t=B(r,n)),t}),ue=f((r="")=>new Promise((n=C)=>{p(t=>{let u=i(t.values);if(r!==""){const m=Array.isArray(r)?r:[r];let w=A({},t.errors);m.forEach(S=>{const q=_(S,u);w=B(S,w),q!==void 0&&(w=k(S,w,q))}),u=w}const d=L(A({},t),{errors:u});return n(d),d})})),De=ce||V.current&&Be,Fe=f((r,n)=>{let t=R;if((De||O(r))&&(t=B(r,t),!te)){const u=_(r,i(n));u&&(t=k(r,t,u))}return t}),fe=f((r,n,t=Fe)=>p(u=>{const d=k(r,u.values,n);return E.current=!0,F.current=G.current!==K(d),{values:d,errors:t(r,d)}})),b=f((r,n,t)=>{p(u=>{const d=n(_(r,u.values)),m=k(r,u.values,d);let w=u.errors;const S=_(r,w);if(t&&Array.isArray(S)){const J=t(S);S.message&&(J.message=S.message,J.type=S.type),w=J.length>0?k(r,w,J):B(r,w)}return E.current=!0,F.current=G.current!==K(m),{values:m,errors:w}})}),Ve=f((r,n)=>{b(r,t=>[...t,n])}),Je=f((r,n)=>{b(r,t=>[n,...t],t=>[void 0,...t])}),Le=f(r=>{const n=()=>[];b(r,n,n)}),je=f((r,n)=>{const t=u=>u.filter((d,m)=>m!==n);b(r,t,t)}),ze=f((r,n,t)=>{const u=d=>Ae(d,n,t);b(r,u,u)}),Ue=f(r=>T.current.get(r)),de=f((r,n)=>{n&&T.current.set(r,n)}),We=f(r=>r&&de(r.name,r)),le=f(r=>fe(r.target.name,Se(r))),pe=f(r=>{const{name:n}=r.target,t=_(n,i(N));t?(M(k(n,R,t)),c&&X(n)):M(ae(n))}),Ye=f((r,n="")=>{const t=ie(r),u=O(r);return v.name=r,v[ne]=u,v.className=Y(x,u?o:"",n),v.onChange=le,v.ref=We,v.onBlur=oe?pe:void 0,t===!0||t===!1?(v.checked=t,v.value=void 0):(v.value=`${t}`=="0"?t:t||"",v.checked=void 0),v}),He=f((r=e,n=!0)=>{Q(r),E.current=!1,F.current=!1,n&&ue("",r)}),Ke=r=>n=>{n&&n.preventDefault();const t=i(N);if(M(t),O("",t)){if(c){let u=!1;T.current.forEach((d,m)=>{!u&&O(m,t)&&(u=X(m))})}return V.current=!0,!1}return r(N),!0},Ge=f(({for:r,children:n})=>{const t=Z(r,R);return!t||!t.message?!1:$(n)?n(t):H("span",{className:Y(t,o),children:t.message})}),ye=!O(),Qe=f(({children:r,focusable:n=!1})=>{if(ye)return!1;const u=Array.from(T.current).filter(d=>!!d[1]).map(d=>d[0]).filter(d=>O(d,R)).sort().map(d=>{const m=Z(d);return H("li",{className:Y(m,o),children:n?H("a",{onClick:()=>X(d),children:m.message}):m.message},d)});return $(r)?r(u):u});return{getValue:ie,setValue:fe,register:Ye,onChange:le,onBlur:pe,getRef:Ue,setRef:de,trigger:ue,handleSubmit:Ke,hasError:O,getError:Z,clearError:r=>M(ae(r)),setErrors:r=>{V.current=!0,M(r)},array:{clear:Le,append:Ve,prepend:Je,remove:je,swap:ze},key:we,Error:Ge,Errors:Qe,formState:{errors:R,isValid:ye,isTouched:E.current,isDirty:F.current,hadError:V.current,reset:He}}};l.default=Ie,l.yupResolver=ke,l.zodResolver=Oe,Object.defineProperty(l,"__esModule",{value:!0}),l[Symbol.toStringTag]="Module"});
