var Xe=Object.defineProperty,Ze=Object.defineProperties;var qe=Object.getOwnPropertyDescriptors;var _e=Object.getOwnPropertySymbols;var Pe=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable;var Se=(p,i,g)=>i in p?Xe(p,i,{enumerable:!0,configurable:!0,writable:!0,value:g}):p[i]=g,w=(p,i)=>{for(var g in i||(i={}))Pe.call(i,g)&&Se(p,g,i[g]);if(_e)for(var g of _e(i))$e.call(i,g)&&Se(p,g,i[g]);return p},C=(p,i)=>Ze(p,qe(i));(function(p,i){typeof exports=="object"&&typeof module!="undefined"?i(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],i):(p=typeof globalThis!="undefined"?globalThis:p||self,i(p["@rvision/use-form"]={},p.react))})(this,function(p,i){"use strict";function g(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var ve=g(i);const te=e=>typeof e=="function",B={},re=()=>B;let we=2e9;const T=new WeakMap,Re=e=>{let t=T.get(e);return t||(t=(we++).toString(36),T.set(e,t)),t},se=e=>{let t;if(e instanceof Set)t=new Set([...e]);else{const n=Array.isArray(e);t=n?[...e]:w({},e),n&&e.message&&(t.message=e.message,t.type=e.type)}return T.has(e)&&(T.set(t,T.get(e)),T.delete(e)),t},Oe=/\[([^\]]+)\]/g;let U=new Map;const W=e=>{if(!e)return[];let t=U.get(e);return t||(t=e.replace(Oe,".$1").split(".").map(n=>+n-+n<1?+n:n),U.set(e,t),t)},ke=()=>{U=new Map},Y=(e,t)=>{if(t!==void 0)return e.length===0?t:Y(e.slice(1),t[e[0]])},S=(e,t)=>Y(W(e),t),ne=(e,t,n)=>{const{length:o}=e;if(o===0)return;const a=e[0];if(o===1){t[a]=n;return}const l=t[a]!==void 0,y=e[1],v=+y-+y<1;t[a]=l?se(t[a]):v?[]:{},v&&(t[a][y]=t[a][y]===void 0?{}:se(t[a][y])),ne(e.slice(1),t[a],n)},R=(e,t,n)=>{const o=w({},t);return ne(W(e),o,n),o},I=(e,t)=>{const{length:n}=e;if(n===0||t===void 0)return;const o=e[0];if(n===1){delete t[o];return}I(e.slice(1),t[o])},H=e=>Object.keys(e||B).length===0,Ae=(e,t)=>{I(e,t),e.map((o,a)=>a===0?[...e]:[...e].slice(0,-1*a)).forEach(o=>{const a=Y(o,t);a!==void 0&&(Array.isArray(a)?(a.length===0||a.every(H))&&!a.message&&I(o,t):H(a)&&I(o,t))})},D=(e,t)=>{const n=w({},t);return Ae(W(e),n),n},Ne=e=>{const{value:t,type:n,checked:o,options:a,files:l,multiple:y,valueAsNumber:v,valueAsDate:x}=e.target;switch(n){case"checkbox":return o;case"range":return v;case"date":return x;case"number":{if(t==="")return null;const m=Number.parseFloat(t);return+m-+m<1?+m:void 0}case"file":return y?l:l.item(0);case"select-multiple":return[...a].filter(m=>m.selected).map(m=>m.value);default:return t}},Te=(e,t,n)=>{const o=[...e];return[o[t],o[n]]=[o[n],o[t]],o},oe=(e,t,n)=>{const o=[...e];return o.splice(t,0,n),o},K=(e,t,n)=>[n,t,e].filter(o=>!!o).map(o=>`${o.type?`error-${o.type}`:o}`).join(" "),xe=e=>t=>{let n={};try{e.validateSync(t,{abortEarly:!1})}catch(o){for(const a of o.inner){const l=S(a.path,n)||{};l.message=a.message,l.type=a.type,n=R(a.path,n,l)}}return n},Me=e=>t=>{let n={};const o=e.safeParse(t);return o.success||o.error.errors.forEach(a=>{const l=a.path.join("."),y=S(l,n)||{};y.message=a.message,y.type=a.type,n=R(l,n,y)}),n};var ce={exports:{}},F={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var be=ve.default,Ce=Symbol.for("react.element"),Be=Symbol.for("react.fragment"),Ie=Object.prototype.hasOwnProperty,De=be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Fe={key:!0,ref:!0,__self:!0,__source:!0};function ie(e,t,n){var o,a={},l=null,y=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(y=t.ref);for(o in t)Ie.call(t,o)&&!Fe.hasOwnProperty(o)&&(a[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps,t)a[o]===void 0&&(a[o]=t[o]);return{$$typeof:Ce,type:e,key:l,ref:y,props:a,_owner:De.current}}F.Fragment=Be,F.jsx=ie,F.jsxs=ie,ce.exports=F;const h=ce.exports.jsx,G=e=>JSON.stringify(e,(t,n)=>n instanceof Set?[...n].sort():n),Q=new Map,Je=(e,t)=>(Q.set(e,t),i.useEffect(()=>()=>Q.delete(e),[e]),i.useCallback((...n)=>Q.get(e)(...n),[e])),Ve=({id:e,defaultValues:t,mode:n,classNameError:o,shouldFocusError:a=!1,resolver:l=re})=>{const[y,v]=i.useState({values:t||B,errors:{}}),{values:x,errors:m}=y,J=i.useRef(!1),V=i.useRef(!1),M=i.useRef(!1),O=i.useRef(new Map),X=i.useRef(),ae=n==="onSubmit",ue=n==="onBlur",Z=n==="onChange",fe=!ae&&!ue&&!Z,[de]=i.useState(()=>(r,c)=>v(s=>{const u=R(r,s.values,c);J.current=!0,V.current=X.current!==G(u);let f=s.errors;if((Z||M.current&&fe||A(r,f))&&(f=D(r,f),!ae)){const d=S(r,l(u));d&&(f=R(r,f,d))}return{values:u,errors:f}})),[Le]=i.useState(()=>{const r=(s,u,f)=>{v(d=>{const E=R(s,d.values,u(S(s,d.values)));J.current=!0,V.current=X.current!==G(E);let _=d.errors;const b=S(s,_);let N=[];if(Array.isArray(b)&&(N=f(b)),Z||M.current&&fe){const z=S(s,l(E));if(z&&z.message){const ee=N.length>0?N:{};ee.message=z.message,ee.type=z.type,N=ee}}return _=D(s,_),(N.length>0||N.message)&&(_=R(s,_,N)),{values:E,errors:_}})},c=(s,u,f)=>{r(s,d=>oe(d,u,f),d=>oe(d,u,void 0))};return{insert:c,append:(s,u)=>c(s,$(s).length,u),prepend:(s,u)=>c(s,0,u),clear:s=>{const u=()=>[];r(s,u,u)},remove:(s,u)=>{const f=d=>[...d].filter((E,_)=>_!==u);r(s,f,f)},swap:(s,u,f)=>{const d=E=>Te(E,u,f);r(s,d,d)}}}),[L]=i.useState(()=>r=>v(c=>C(w({},c),{errors:r}))),[je]=i.useState(()=>r=>{M.current=!0,L(r)}),[q]=i.useState(()=>r=>{const c=r||B;X.current=G(c),v(s=>C(w({},s),{values:w({},c)}))}),[P]=i.useState(()=>r=>{const c=O.current.get(r);return c&&c.focus?(c.focus(),!0):!1}),[le]=i.useState(()=>(r="")=>new Promise((c=re)=>{v(s=>{let u=l(s.values);if(r!==""){const d=Array.isArray(r)?r:[r];let E=w({},s.errors);d.forEach(_=>{const b=S(_,u);E=D(_,E),b!==void 0&&(E=R(_,E,b))}),u=E}const f=C(w({},s),{errors:u});return c(f),f})})),[pe]=i.useState(()=>(r,c)=>{let s=c;return A(r,c)&&(s=D(r,c)),s}),[ze]=i.useState(()=>r=>v(c=>{const s=c.errors,u=pe(r,s);return u===s?c:C(w({},c),{errors:u})})),[Ue]=i.useState(()=>r=>O.current.get(r)),[ye]=i.useState(()=>(r,c)=>{c&&O.current.set(r,c)}),[We]=i.useState(()=>r=>r&&ye(r.name,r)),[Ye]=i.useState(()=>(r,c=!0)=>{q(r||t),J.current=!1,V.current=!1,c&&le("",r)}),[me]=i.useState(()=>r=>de(r.target.name,Ne(r)));let He=1;const k=r=>Je(`${e}!${He++}`,r);i.useEffect(()=>(q(t),()=>{ke()}),[t,q]);const $=k((r="")=>(O.current.has(r)||O.current.set(r,null),S(r,x))),j=k((r="",c=m)=>S(r,c)),A=k((r="",c=m)=>r===""?!H(c):S(r,c)!==void 0),ge=k(r=>{const{name:c}=r.target,s=S(c,l(x));s?(L(R(c,m,s)),a&&P(c)):L(pe(c,m))}),Ke=k((r,c="")=>{const s=$(r),u=j(r),f=s===!0||s===!1;return{name:r,["aria-invalid"]:!!u,className:K(u,u?o:"",c),onChange:me,onBlur:ue?ge:void 0,ref:We,value:f?void 0:`${s}`=="0"?s:s||"",checked:f?s:void 0}}),he=r=>c=>{c&&c.preventDefault();const s=l(x);if(L(s),A("",s)){if(a){let u=!1;O.current.forEach((f,d)=>{!u&&A(d,s)&&(u=P(d))})}return M.current=!0,!1}return r(x),!0},Ge=k(({for:r,children:c})=>{const s=j(r,m);return(s==null?void 0:s.message)?te(c)?c(s):h("span",{className:K(s,o),children:s.message}):!1}),Ee=!A(),Qe=k(({children:r,focusable:c=!1})=>{if(Ee)return!1;const u=Array.from(O.current).map(f=>f[0]).filter(f=>f!=="").filter(f=>A(f,m)).sort().map(f=>{const d=j(f);return h("li",{className:K(d,o),children:c?h("a",{onClick:()=>P(f),children:d.message}):d.message},f)});return te(r)?r(u):u});return{getValue:$,setValue:de,register:Ke,onChange:me,onBlur:ge,getRef:Ue,setRef:ye,trigger:le,handleSubmit:he,hasError:A,getError:j,clearError:ze,setErrors:je,array:Le,key:Re,Error:Ge,Errors:Qe,formState:{errors:m,isValid:Ee,isTouched:J.current,isDirty:V.current,hadError:M.current,reset:Ye}}};p.default=Ve,p.yupResolver=xe,p.zodResolver=Me,Object.defineProperty(p,"__esModule",{value:!0}),p[Symbol.toStringTag]="Module"});
