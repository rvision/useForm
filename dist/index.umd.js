var Ge=Object.defineProperty,Qe=Object.defineProperties;var Xe=Object.getOwnPropertyDescriptors;var me=Object.getOwnPropertySymbols;var Ze=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable;var ge=(l,i,g)=>i in l?Ge(l,i,{enumerable:!0,configurable:!0,writable:!0,value:g}):l[i]=g,A=(l,i)=>{for(var g in i||(i={}))Ze.call(i,g)&&ge(l,g,i[g]);if(me)for(var g of me(i))qe.call(i,g)&&ge(l,g,i[g]);return l},J=(l,i)=>Qe(l,Xe(i));(function(l,i){typeof exports=="object"&&typeof module!="undefined"?i(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],i):(l=typeof globalThis!="undefined"?globalThis:l||self,i(l["@rvision/use-form"]={},l.react))})(this,function(l,i){"use strict";function g(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Ee=g(i);const $=e=>typeof e=="function",b={},x=()=>b;let ve=2e9;const T=new WeakMap,_e=e=>{let r=T.get(e);return r||(r=(ve++).toString(36),T.set(e,r)),r},P=e=>{let r;if(e instanceof Set)r=new Set([...e]);else{const t=Array.isArray(e);r=t?[...e]:A({},e),t&&e.message&&(r.message=e.message,r.type=e.type)}return T.has(e)&&(T.set(r,T.get(e)),T.delete(e)),r},we=/\[([^\]]+)\]/g;let z=new Map;const U=e=>{if(!e)return[];let r=z.get(e);return r||(r=e.replace(we,".$1").split(".").map(t=>isNaN(parseInt(t,10))?t:+t),z.set(e,r),r)},Ne=()=>{z=new Map},W=(e,r)=>{if(r!==void 0)return e.length===0?r:W(e.slice(1),r[e[0]])},v=(e,r)=>W(U(e),r),ee=(e,r,t)=>{const{length:c}=e;if(c===0)return;const a=e[0];if(c===1){r[a]=t;return}const y=r[a]!==void 0,p=e[1],R=!isNaN(p);r[a]=y?P(r[a]):R?[]:{},R&&(r[a][p]=r[a][p]===void 0?{}:P(r[a][p])),ee(e.slice(1),r[a],t)},O=(e,r,t)=>{const c=A({},r);return ee(U(e),c,t),c},B=(e,r)=>{const{length:t}=e;if(t===0||r===void 0)return;const c=e[0];if(t===1){delete r[c];return}B(e.slice(1),r[c])},Y=e=>Object.keys(e||b).length===0,Re=(e,r)=>{B(e,r),e.map((c,a)=>a===0?[...e]:[...e].slice(0,-1*a)).forEach(c=>{const a=W(c,r);a!==void 0&&(Array.isArray(a)?(a.length===0||a.every(Y))&&!a.message&&B(c,r):Y(a)&&B(c,r))})},D=(e,r)=>{const t=A({},r);return Re(U(e),t),t},ke=e=>{const{value:r,type:t,checked:c,options:a,files:y,multiple:p,valueAsNumber:R,valueAsDate:m}=e.target;switch(t){case"checkbox":return c;case"range":return R;case"date":return m;case"number":{if(r==="")return null;const w=Number.parseFloat(r);return isNaN(w)?void 0:+w}case"file":return p?y:y.item(0);case"select-multiple":return[...a].filter(w=>w.selected).map(w=>w.value);default:return r}},Ae=(e,r,t)=>{if(Array.isArray(e)){const c=[...e];for(;c.length<r+1||c.length<t+1;)c.length++;return[c[r],c[t]]=[c[t],c[r]],c}return e},j=(e,r,t)=>`${t||""} ${r||""} ${e.type?`error-${e.type}`:""}`.trim(),Oe=e=>r=>{let t={};try{e.validateSync(r,{abortEarly:!1})}catch(c){for(const a of c.inner){const y=v(a.path,t)||{};y.message=a.message,y.type=a.type,t=O(a.path,t,y)}}return t},Se=e=>r=>{let t={};const c=e.safeParse(r);return c.success||c.error.errors.forEach(a=>{const y=a.path.join("."),p=v(y,t)||{};p.message=a.message,p.type=a.type,t=O(y,t,p)}),t};var re={exports:{}},F={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ce=Ee.default,he=Symbol.for("react.element"),Te=Symbol.for("react.fragment"),be=Object.prototype.hasOwnProperty,xe=Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ie={key:!0,ref:!0,__self:!0,__source:!0};function se(e,r,t){var c,a={},y=null,p=null;t!==void 0&&(y=""+t),r.key!==void 0&&(y=""+r.key),r.ref!==void 0&&(p=r.ref);for(c in r)be.call(r,c)&&!Ie.hasOwnProperty(c)&&(a[c]=r[c]);if(e&&e.defaultProps)for(c in r=e.defaultProps,r)a[c]===void 0&&(a[c]=r[c]);return{$$typeof:he,type:e,key:y,ref:p,props:a,_owner:xe.current}}F.Fragment=Te,F.jsx=se,F.jsxs=se,re.exports=F;const H=re.exports.jsx,ne="aria-invalid",K=e=>JSON.stringify(e,(r,t)=>t instanceof Set?[...t].sort():t),E=e=>{const r=i.useRef(e);return i.useLayoutEffect(()=>{r.current=e}),i.useCallback((...t)=>r.current(...t),[])},_={name:"",[ne]:!1,className:"",onChange:x,onBlur:x,ref:x,value:"",checked:!1},Me=({defaultValues:e,mode:r,classNameError:t,shouldFocusError:c=!1,resolver:a=x})=>{const[y,p]=i.useState({values:e||b,errors:{}}),{values:R,errors:m}=y,w=i.useRef(!1),L=i.useRef(!1),V=i.useRef(!1),C=i.useRef(new Map),G=i.useRef(),te=r==="onSubmit",oe=r==="onBlur",ce=r==="onChange",Be=!te&&!oe&&!ce,I=s=>p(n=>J(A({},n),{errors:s})),Q=i.useCallback(s=>{const n=s||b;G.current=K(n),p(o=>J(A({},o),{values:A({},n)}))},[]);i.useEffect(()=>(Q(e),Ne),[e,Q]);const X=i.useCallback(s=>{const n=C.current.get(s);return n&&n.focus?(n.focus(),!0):!1},[]),ae=(s="")=>(C.current.has(s)||C.current.set(s,null),v(s,R)),Z=i.useCallback((s="",n=m)=>v(s,n),[m]),k=i.useCallback((s="",n=m)=>s===""?!Y(n):v(s,n)!==void 0,[m]),ie=E((s,n=m)=>{let o=n;return k(s,n)&&(o=D(s,n)),o}),ue=E((s="")=>new Promise((n=x)=>{p(o=>{let u=a(o.values);if(s!==""){const d=Array.isArray(s)?s:[s];let S=A({},o.errors);d.forEach(N=>{const h=v(N,u);S=D(N,S),h!==void 0&&(S=O(N,S,h))}),u=S}const f=J(A({},o),{errors:u});return n(f),f})})),fe=ce||V.current&&Be,le=E((s,n)=>p(o=>{const u=s===""?n:O(s,o.values,n);w.current=!0,L.current=G.current!==K(u);let f=m;if((fe||k(s))&&(f=D(s,f),!te)){const d=v(s,a(u));d&&(f=O(s,f,d))}return{values:u,errors:f}})),M=E((s,n,o)=>{p(u=>{const f=O(s,u.values,n(v(s,u.values)));w.current=!0,L.current=G.current!==K(f);let d=u.errors;const S=v(s,d);let N=[];if(Array.isArray(S)&&(N=o(S)),fe){const h=v(s,a(f));if(h&&h.message){const q=N.length>0?N:{};q.message=h.message,q.type=h.type,N=q}}return d=D(s,d),(N.length>0||N.message)&&(d=O(s,d,N)),{values:f,errors:d}})}),De=E((s,n)=>{M(s,o=>[...o,n],o=>o)}),Fe=E((s,n)=>{M(s,o=>[n,...o],o=>[void 0,...o])}),Le=E(s=>{const n=()=>[];M(s,n,n)}),Ve=E((s,n)=>{const o=u=>[...u].filter((f,d)=>d!==n);M(s,o,o)}),Je=E((s,n,o)=>{const u=f=>Ae(f,n,o);M(s,u,u)}),ze=s=>C.current.get(s),de=(s,n)=>{n&&C.current.set(s,n)},Ue=s=>s&&de(s.name,s),pe=E(s=>le(s.target.name,ke(s))),ye=E(s=>{const{name:n}=s.target,o=v(n,a(R));o?(I(O(n,m,o)),c&&X(n)):I(ie(n))}),We=(s,n="")=>{const o=ae(s),u=k(s);return _.name=s,_[ne]=u,_.className=j(b,u?t:"",n),_.onChange=pe,_.ref=Ue,_.onBlur=oe?ye:void 0,o===!0||o===!1?(_.checked=o,_.value=void 0):(_.value=`${o}`=="0"?o:o||"",_.checked=void 0),_},Ye=E((s=e,n=!0)=>{Q(s),w.current=!1,L.current=!1,n&&ue("",s)}),je=s=>n=>{n&&n.preventDefault();const o=a(R);if(I(o),k("",o)){if(c){let u=!1;C.current.forEach((f,d)=>{!u&&k(d,o)&&(u=X(d))})}return V.current=!0,!1}return s(R),!0},He=i.useCallback(({for:s,children:n})=>{const o=Z(s,m);return(o==null?void 0:o.message)?$(n)?n(o):H("span",{className:j(o,t),children:o.message}):!1},[m]),Ke=i.useCallback(({children:s,focusable:n=!1})=>{if(!k())return!1;const u=Array.from(C.current).map(f=>f[0]).filter(f=>k(f,m)).sort().map(f=>{const d=Z(f);return H("li",{className:j(d,t),children:n?H("a",{onClick:()=>X(f),children:d.message}):d.message},f)});return $(s)?s(u):u},[m]);return{getValue:ae,setValue:le,register:We,onChange:pe,onBlur:ye,getRef:ze,setRef:de,trigger:ue,handleSubmit:je,hasError:k,getError:Z,clearError:s=>I(ie(s)),setErrors:s=>{V.current=!0,I(s)},array:{clear:Le,append:De,prepend:Fe,remove:Ve,swap:Je},key:_e,Error:He,Errors:Ke,formState:{errors:m,isValid:!k(),isTouched:w.current,isDirty:L.current,hadError:V.current,reset:Ye}}};l.default=Me,l.yupResolver=Oe,l.zodResolver=Se,Object.defineProperty(l,"__esModule",{value:!0}),l[Symbol.toStringTag]="Module"});
