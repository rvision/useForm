var Ge=Object.defineProperty,Qe=Object.defineProperties;var Xe=Object.getOwnPropertyDescriptors;var ve=Object.getOwnPropertySymbols;var Ze=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable;var Se=(p,i,g)=>i in p?Ge(p,i,{enumerable:!0,configurable:!0,writable:!0,value:g}):p[i]=g,w=(p,i)=>{for(var g in i||(i={}))Ze.call(i,g)&&Se(p,g,i[g]);if(ve)for(var g of ve(i))qe.call(i,g)&&Se(p,g,i[g]);return p},z=(p,i)=>Qe(p,Xe(i));(function(p,i){typeof exports=="object"&&typeof module!="undefined"?i(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],i):(p=typeof globalThis!="undefined"?globalThis:p||self,i(p["@rvision/use-form"]={},p.react))})(this,function(p,i){"use strict";function g(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var _e=g(i);const te=e=>typeof e=="function",B={},se=()=>B;let we=2e9;const T=new WeakMap,Re=e=>{let t=T.get(e);return t||(t=(we++).toString(36),T.set(e,t)),t},re=e=>{let t;if(e instanceof Set)t=new Set([...e]);else{const n=Array.isArray(e);t=n?[...e]:w({},e),n&&e.message&&(t.message=e.message,t.type=e.type)}return T.has(e)&&(T.set(t,T.get(e)),T.delete(e)),t},Oe=/\[([^\]]+)\]/g;let U=new Map;const W=e=>{if(!e)return[];let t=U.get(e);return t||(t=e.replace(Oe,".$1").split(".").map(n=>+n-+n<1?+n:n),U.set(e,t),t)},ke=()=>{U=new Map},Y=(e,t)=>{if(t!==void 0)return e.length===0?t:Y(e.slice(1),t[e[0]])},S=(e,t)=>Y(W(e),t),ne=(e,t,n)=>{const{length:o}=e;if(o===0)return;const a=e[0];if(o===1){t[a]=n;return}const l=t[a]!==void 0,y=e[1],_=+y-+y<1;t[a]=l?re(t[a]):_?[]:{},_&&(t[a][y]=t[a][y]===void 0?{}:re(t[a][y])),ne(e.slice(1),t[a],n)},R=(e,t,n)=>{const o=w({},t);return ne(W(e),o,n),o},I=(e,t)=>{const{length:n}=e;if(n===0||t===void 0)return;const o=e[0];if(n===1){delete t[o];return}I(e.slice(1),t[o])},H=e=>Object.keys(e||B).length===0,Ae=(e,t)=>{I(e,t),e.map((o,a)=>a===0?[...e]:[...e].slice(0,-1*a)).forEach(o=>{const a=Y(o,t);a!==void 0&&(Array.isArray(a)?(a.length===0||a.every(H))&&!a.message&&I(o,t):H(a)&&I(o,t))})},D=(e,t)=>{const n=w({},t);return Ae(W(e),n),n},Ne=e=>{const{value:t,type:n,checked:o,options:a,files:l,multiple:y,valueAsNumber:_,valueAsDate:x}=e.target;switch(n){case"checkbox":return o;case"range":return _;case"date":return x;case"number":{if(t==="")return null;const m=Number.parseFloat(t);return+m-+m<1?+m:void 0}case"file":return y?l:l.item(0);case"select-multiple":return[...a].filter(m=>m.selected).map(m=>m.value);default:return t}},Te=(e,t,n)=>{const o=[...e];return[o[t],o[n]]=[o[n],o[t]],o},oe=(e,t,n)=>{const o=[...e];return o.splice(t,0,n),o},K=(e,t,n)=>[n,t,e].filter(o=>!!o).map(o=>`${o.type?`error-${o.type}`:o}`).join(" "),xe=e=>t=>{let n={};try{e.validateSync(t,{abortEarly:!1})}catch(o){for(const a of o.inner){const l=S(a.path,n)||{};l.message=a.message,l.type=a.type,n=R(a.path,n,l)}}return n},Me=e=>t=>{let n={};const o=e.safeParse(t);return o.success||o.error.errors.forEach(a=>{const l=a.path.join("."),y=S(l,n)||{};y.message=a.message,y.type=a.type,n=R(l,n,y)}),n};var ce={exports:{}},F={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var be=_e.default,Ce=Symbol.for("react.element"),Be=Symbol.for("react.fragment"),Ie=Object.prototype.hasOwnProperty,De=be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Fe={key:!0,ref:!0,__self:!0,__source:!0};function ie(e,t,n){var o,a={},l=null,y=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(y=t.ref);for(o in t)Ie.call(t,o)&&!Fe.hasOwnProperty(o)&&(a[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps,t)a[o]===void 0&&(a[o]=t[o]);return{$$typeof:Ce,type:e,key:l,ref:y,props:a,_owner:De.current}}F.Fragment=Be,F.jsx=ie,F.jsxs=ie,ce.exports=F;const h=ce.exports.jsx,G=e=>JSON.stringify(e,(t,n)=>n instanceof Set?[...n].sort():n),Q=new Map,Je=(e,t)=>(Q.set(e,t),i.useEffect(()=>()=>Q.delete(e),[e]),i.useCallback((...n)=>Q.get(e)(...n),[e])),Ve=({id:e,defaultValues:t,mode:n,classNameError:o,shouldFocusError:a=!1,resolver:l=se})=>{const[y,_]=i.useState({values:t||B,errors:{}}),{values:x,errors:m}=y,J=i.useRef(!1),V=i.useRef(!1),M=i.useRef(!1),O=i.useRef(new Map),X=i.useRef(),ae=n==="onSubmit",ue=n==="onBlur",Z=n==="onChange",fe=!ae&&!ue&&!Z,[de]=i.useState(()=>(s,c)=>_(r=>{const u=R(s,r.values,c);J.current=!0,V.current=X.current!==G(u);let f=r.errors;if((Z||M.current&&fe||A(s,f))&&(f=D(s,f),!ae)){const d=S(s,l(u));d&&(f=R(s,f,d))}return{values:u,errors:f}})),[Le]=i.useState(()=>{const s=(r,u,f)=>{_(d=>{const E=R(r,d.values,u(S(r,d.values)));J.current=!0,V.current=X.current!==G(E);let v=d.errors;const C=S(r,v);let N=[];if(Array.isArray(C)&&(N=f(C)),Z||M.current&&fe){const j=S(r,l(E));if(j&&j.message){const ee=N.length>0?N:{};ee.message=j.message,ee.type=j.type,N=ee}}return v=D(r,v),(N.length>0||N.message)&&(v=R(r,v,N)),{values:E,errors:v}})},c=(r,u,f)=>{s(r,d=>oe(d,u,f),d=>oe(d,u,void 0))};return{insert:c,append:(r,u)=>c(r,$(r).length,u),prepend:(r,u)=>c(r,0,u),clear:r=>{const u=()=>[];s(r,u,u)},remove:(r,u)=>{const f=d=>[...d].filter((E,v)=>v!==u);s(r,f,f)},swap:(r,u,f)=>{const d=E=>Te(E,u,f);s(r,d,d)}}}),[b]=i.useState(()=>s=>_(c=>z(w({},c),{errors:s}))),[q]=i.useState(()=>s=>{const c=s||B;X.current=G(c),_(r=>z(w({},r),{values:w({},c)}))}),[P]=i.useState(()=>s=>{const c=O.current.get(s);return c&&c.focus?(c.focus(),!0):!1}),[le]=i.useState(()=>(s="")=>new Promise((c=se)=>{_(r=>{let u=l(r.values);if(s!==""){const d=Array.isArray(s)?s:[s];let E=w({},r.errors);d.forEach(v=>{const C=S(v,u);E=D(v,E),C!==void 0&&(E=R(v,E,C))}),u=E}const f=z(w({},r),{errors:u});return c(f),f})})),[pe]=i.useState(()=>(s,c)=>{let r=c;return A(s,c)&&(r=D(s,c)),r}),[je]=i.useState(()=>s=>O.current.get(s)),[ye]=i.useState(()=>(s,c)=>{c&&O.current.set(s,c)}),[ze]=i.useState(()=>s=>s&&ye(s.name,s)),[Ue]=i.useState(()=>(s,c=!0)=>{q(s||t),J.current=!1,V.current=!1,c&&le("",s)}),[me]=i.useState(()=>s=>de(s.target.name,Ne(s)));let We=1;const k=s=>Je(`${e}!${We++}`,s);i.useEffect(()=>(q(t),()=>{ke()}),[t,q]);const $=k((s="")=>(O.current.has(s)||O.current.set(s,null),S(s,x))),L=k((s="",c=m)=>S(s,c)),A=k((s="",c=m)=>s===""?!H(c):S(s,c)!==void 0),ge=k(s=>{const{name:c}=s.target,r=S(c,l(x));r?(b(R(c,m,r)),a&&P(c)):b(pe(c,m))}),Ye=k((s,c="")=>{const r=$(s),u=L(s),f=r===!0||r===!1;return{name:s,["aria-invalid"]:!!u,className:K(u,u?o:"",c),onChange:me,onBlur:ue?ge:void 0,ref:ze,value:f?void 0:`${r}`=="0"?r:r||"",checked:f?r:void 0}}),He=s=>c=>{c&&c.preventDefault();const r=l(x);if(b(r),A("",r)){if(a){let u=!1;O.current.forEach((f,d)=>{!u&&A(d,r)&&(u=P(d))})}return M.current=!0,!1}return s(x),!0},Ke=k(({for:s,children:c})=>{const r=L(s,m);return(r==null?void 0:r.message)?te(c)?c(r):h("span",{className:K(r,o),children:r.message}):!1}),Ee=!A(),he=k(({children:s,focusable:c=!1})=>{if(Ee)return!1;const u=Array.from(O.current).map(f=>f[0]).filter(f=>f!=="").filter(f=>A(f,m)).sort().map(f=>{const d=L(f);return h("li",{className:K(d,o),children:c?h("a",{onClick:()=>P(f),children:d.message}):d.message},f)});return te(s)?s(u):u});return{getValue:$,setValue:de,register:Ye,onChange:me,onBlur:ge,getRef:je,setRef:ye,trigger:le,handleSubmit:He,hasError:A,getError:L,clearError:s=>b(pe(s,m)),setErrors:s=>{M.current=!0,b(s)},array:Le,key:Re,Error:Ke,Errors:he,formState:{errors:m,isValid:Ee,isTouched:J.current,isDirty:V.current,hadError:M.current,reset:Ue}}};p.default=Ve,p.yupResolver=xe,p.zodResolver=Me,Object.defineProperty(p,"__esModule",{value:!0}),p[Symbol.toStringTag]="Module"});
